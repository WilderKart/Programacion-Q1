<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sameco Premium Scheduler | Q1 2026</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    
    <style>
        /* --- CORE STYLES & THEME VARIABLES --- */
        :root {
            --glass-bg: rgba(255, 255, 255, 0.85);
            --glass-border: rgba(255, 255, 255, 0.5);
            --glass-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.15);
        }

        body {
            font-family: 'Poppins', sans-serif;
            background-color: #f3f4f6;
            transition: background 0.5s ease;
            overflow-y: auto; 
            overflow-x: hidden;
            min-height: 100vh;
        }
        
        /* Contenedor principal para control de altura en desktop */
        .main-dashboard-container {
            max-width: 90rem; 
            width: 100%;
            height: 90vh; 
            max-height: 90vh;
            overflow: hidden; 
        }
        
        @media (max-width: 768px) {
            .main-dashboard-container {
                /* En m√≥vil, permite que crezca verticalmente */
                height: auto;
                max-height: none;
                overflow: visible;
                padding-bottom: 2rem;
            }
            
            /* Ajustar el grid semanal para que sea de 1 columna en m√≥vil */
             #weekly-grid {
                grid-template-columns: repeat(1, minmax(0, 1fr)) !important;
            }
        }

        /* Temas de Color por Asesor */
        body.theme-cristina { background-image: linear-gradient(120deg, #e0c3fc 0%, #8ec5fc 100%); --primary: #8b5cf6; --secondary: #d946ef; } /* P√∫rpura/Rosa */
        body.theme-julio { background-image: linear-gradient(120deg, #06b6d4 0%, #10b981 100%); --primary: #14b8a6; --secondary: #0d9488; } /* Verde Teal */
        body.theme-steven { background-image: linear-gradient(120deg, #f6d365 0%, #fda085 100%); --primary: #f59e0b; --secondary: #f97316; } /* Naranja/√Åmbar */

        /* Glassmorphism Panel */
        .glass-panel {
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border);
            box-shadow: var(--glass-shadow);
        }

        /* Sidebar Item Styles */
        .advisor-card {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            border: 2px solid transparent;
        }
        .advisor-card:hover {
            transform: translateY(-2px);
            background: rgba(255,255,255, 0.6);
        }
        .advisor-card.active {
            background: white;
            border-color: var(--primary);
            box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1);
        }
        .advisor-card.active .status-dot {
            background-color: #10b981; 
            box-shadow: 0 0 0 3px white;
        }

        /* Pesta√±as de Meses Activas */
        .month-tab.active {
            position: relative;
        }
        .month-tab.active::after {
            content: '';
            position: absolute;
            bottom: -8px;
            left: 50%;
            transform: translateX(-50%);
            width: 80%;
            height: 3px;
            background: var(--primary);
            border-radius: 2px;
            transition: width 0.3s ease;
        }

        /* Animations */
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        .animate-fade-in { animation: fadeIn 0.4s ease-out forwards; }

        /* CR√çTICO: Estilo de scroll para que sea casi invisible (inperceptible) */
        .hide-scrollbar::-webkit-scrollbar { width: 5px; }
        .hide-scrollbar::-webkit-scrollbar-track { background: transparent; }
        .hide-scrollbar::-webkit-scrollbar-thumb { background: rgba(0, 0, 0, 0.15); border-radius: 10px; }
        .hide-scrollbar:hover::-webkit-scrollbar-thumb { background: rgba(0, 0, 0, 0.3); }
        .hide-scrollbar { -ms-overflow-style: none; scrollbar-width: thin; }

        /* Tooltip style */
        .tooltip {
            visibility: hidden;
            opacity: 0;
            transition: opacity 0.3s, visibility 0.3s;
            pointer-events: none;
        }

        /* Deshabilitar Tooltip en m√≥vil para evitar problemas de scroll */
        @media (min-width: 768px) {
            .card-container:hover .tooltip {
                visibility: visible;
                opacity: 1;
            }
        }
    </style>
</head>
<body class="flex items-center justify-center p-4 md:p-8 theme-cristina" id="app-body">

    <div class="w-full max-w-7xl main-dashboard-container glass-panel rounded-[2.5rem] flex flex-col md:flex-row relative">

        <aside class="w-full md:w-80 bg-white/40 border-r border-white/50 flex flex-col p-6 z-20 overflow-y-auto hide-scrollbar">
            <div class="flex items-center gap-3 mb-10 pl-2">
                <div class="w-10 h-10 rounded-xl bg-gray-900 text-white flex items-center justify-center text-lg shadow-xl">
                    <i class="fa-solid fa-layer-group"></i>
                </div>
                <h1 class="text-2xl font-bold tracking-tight text-gray-800">Sameco<span class="text-indigo-600">Plan</span></h1>
            </div>

            <p class="text-xs font-bold text-gray-500 uppercase tracking-wider mb-4 px-2">Seleccionar Asesor</p>

            <div class="space-y-4 flex-1">
                
                <div onclick="selectAdvisor('Cristina')" id="card-Cristina" class="advisor-card active cursor-pointer p-4 rounded-2xl flex items-center gap-4">
                    <div class="relative">
                        <img src="img/cristina.png" alt="Cristina" class="profile-img w-14 h-14 rounded-full bg-purple-100 p-0.5 border border-white shadow-sm">
                        <div class="status-dot absolute bottom-0 right-0 w-3.5 h-3.5 bg-gray-300 rounded-full border-2 border-white transition-colors"></div>
                    </div>
                    <div>
                        <h3 class="font-bold text-gray-800">Cristina</h3>
                        <p class="text-xs text-gray-500 font-medium">Asesor Comercial</p>
                    </div>
                </div>

                <div onclick="selectAdvisor('Julio')" id="card-Julio" class="advisor-card cursor-pointer p-4 rounded-2xl flex items-center gap-4">
                    <div class="relative">
                        <img src="img/julio.png" alt="Julio" class="profile-img w-14 h-14 rounded-full bg-blue-100 p-0.5 border border-white shadow-sm">
                        <div class="status-dot absolute bottom-0 right-0 w-3.5 h-3.5 bg-gray-300 rounded-full border-2 border-white transition-colors"></div>
                    </div>
                    <div>
                        <h3 class="font-bold text-gray-800">Julio</h3>
                        <p class="text-xs text-gray-500 font-medium">Asesor Comercial</p>
                    </div>
                </div>

                <div onclick="selectAdvisor('Steven')" id="card-Steven" class="advisor-card cursor-pointer p-4 rounded-2xl flex items-center gap-4">
                    <div class="relative">
                        <img src="img/steven.png" alt="Steven" class="profile-img w-14 h-14 rounded-full bg-orange-100 p-0.5 border border-white shadow-sm">
                        <div class="status-dot absolute bottom-0 right-0 w-3.5 h-3.5 bg-gray-300 rounded-full border-2 border-white transition-colors"></div>
                    </div>
                    <div>
                        <h3 class="font-bold text-gray-800">Steven</h3>
                        <p class="text-xs text-gray-500 font-medium">Asesor Comercial</p>
                    </div>
                </div>

            </div>

            <div class="mt-auto pt-6 border-t border-gray-200/50">
                <div class="bg-gradient-to-br from-orange-500 to-orange-600 p-5 rounded-2xl text-white relative overflow-hidden shadow-lg shadow-orange-500/30 ring-1 ring-white/20 group">
                    <div class="relative z-10">
                        <div class="flex items-center gap-2 mb-2">
                            <span class="bg-white/20 p-1.5 rounded-lg text-xs text-white ring-1 ring-white/30"><i class="fa-solid fa-business-time"></i></span>
                            <p class="text-[10px] font-bold uppercase tracking-widest text-orange-100/80">Regla Operativa</p>
                        </div>
                        <h4 class="font-bold text-xl leading-tight mb-1 text-white">Jornada Reducida</h4>
                        <p class="text-sm text-orange-50 font-medium">1 d√≠a de 5.5h a la semana.</p>
                        <div class="mt-3 text-xs text-orange-100/70 flex items-center gap-1">
                            <i class="fa-regular fa-calendar-check"></i> Rotaci√≥n Semanal
                        </div>
                    </div>
                    <div class="absolute -bottom-8 -right-8 w-32 h-32 bg-orange-400 rounded-full blur-3xl opacity-40 group-hover:opacity-60 transition duration-500"></div>
                    <i class="fa-solid fa-clock-rotate-left absolute bottom-2 right-2 text-white/10 text-5xl -rotate-12"></i>
                </div>
            </div>
        </aside>

        <main class="flex-1 flex flex-col relative overflow-y-auto hide-scrollbar">
            
            <header class="h-20 px-8 flex justify-between items-center border-b border-white/30 bg-white/20 backdrop-blur-sm z-10">
                <div class="flex gap-2 bg-white/50 p-1 rounded-xl">
                    <button onclick="changeMonth('Enero')" id="btn-Enero" class="month-tab px-5 py-2 rounded-lg text-sm font-bold shadow-sm bg-white text-gray-800 transition-all">Enero</button>
                    <button onclick="changeMonth('Febrero')" id="btn-Febrero" class="month-tab px-5 py-2 rounded-lg text-sm font-semibold text-gray-500 hover:text-gray-800 transition-all">Febrero</button>
                    <button onclick="changeMonth('Marzo')" id="btn-Marzo" class="month-tab px-5 py-2 rounded-lg text-sm font-semibold text-gray-500 hover:text-gray-800 transition-all">Marzo</button>
                </div>

                <div class="flex items-center gap-3">
                    <div class="text-right hidden sm:block">
                        <p class="text-xs text-gray-500 uppercase font-bold">Viendo agenda de</p>
                        <p class="text-lg font-bold text-gray-800 leading-none" id="header-name">Cristina</p>
                    </div>
                    <button class="w-10 h-10 rounded-full bg-white shadow-sm flex items-center justify-center text-gray-400 hover:text-gray-600 transition">
                        <i class="fa-regular fa-bell"></i>
                    </button>
                </div>
            </header>

            <div class="flex-1 p-6 md:p-10 hide-scrollbar relative">
                
                <div class="flex flex-col md:flex-row justify-between items-end md:items-center mb-8 gap-4">
                    <div>
                        <h2 class="text-3xl font-bold text-gray-800 mb-1" id="week-display">Semana 1</h2>
                        <div class="flex items-center gap-2 text-gray-500">
                            <i class="fa-solid fa-calendar-week"></i>
                            <span class="text-sm font-medium" id="date-range-display">Enero 1 - Enero 7</span>
                        </div>
                    </div>

                    <div class="flex items-center gap-4">
                        <button onclick="openMonthModal()" class="px-6 py-2.5 bg-gray-900 text-white rounded-xl text-sm font-semibold hover:bg-gray-800 transition shadow-lg flex items-center gap-2">
                            <i class="fa-solid fa-table"></i> Ver Mes Completo
                        </button>

                        <div class="flex bg-white p-1 rounded-xl shadow-sm border border-gray-100">
                            <button onclick="changeWeek(-1)" class="w-10 h-10 hover:bg-gray-100 rounded-lg flex items-center justify-center text-gray-600 transition">
                                <i class="fa-solid fa-chevron-left"></i>
                            </button>
                            <div class="w-px h-6 bg-gray-200 my-auto mx-1"></div>
                            <button onclick="changeWeek(1)" class="w-10 h-10 hover:bg-gray-100 rounded-lg flex items-center justify-center text-gray-600 transition">
                                <i class="fa-solid fa-chevron-right"></i>
                            </button>
                        </div>
                    </div>
                </div>

                <div id="weekly-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-5 pb-10">
                    </div>

            </div>
        </main>
    </div>

    <dialog id="month-modal" class="rounded-3xl shadow-2xl p-0 w-full max-w-4xl backdrop:bg-gray-900/50 open:animate-fade-in">
        <div class="glass-panel flex flex-col max-h-[80vh]">
            <div class="p-6 border-b border-gray-200 flex justify-between items-center bg-white/50">
                <div>
                    <h3 class="text-xl font-bold text-gray-800">Programaci√≥n Mensual</h3>
                    <p class="text-sm text-gray-500" id="modal-subtitle">Enero 2026 - Cristina</p>
                </div>
                <button onclick="closeMonthModal()" class="w-8 h-8 rounded-full bg-gray-100 hover:bg-gray-200 flex items-center justify-center text-gray-600 transition">
                    <i class="fa-solid fa-xmark"></i>
                </button>
            </div>
            
            <div class="overflow-y-auto p-6">
                <table class="w-full text-sm text-left text-gray-600">
                    <thead class="text-xs text-gray-700 uppercase bg-gray-50/80 sticky top-0">
                        <tr>
                            <th scope="col" class="px-6 py-3 rounded-l-lg">Fecha</th>
                            <th scope="col" class="px-6 py-3">D√≠a</th>
                            <th scope="col" class="px-6 py-3">Horario</th>
                            <th scope="col" class="px-6 py-3">Almuerzo</th>
                            <th scope="col" class="px-6 py-3 rounded-r-lg">Nota</th>
                        </tr>
                    </thead>
                    <tbody id="month-table-body" class="bg-white">
                        </tbody>
                </table>
            </div>
            
            <div class="p-4 bg-gray-50/80 text-center text-xs text-gray-400">
                Mostrando informaci√≥n exclusiva para el colaborador seleccionado.
            </div>
        </div>
    </dialog>

    <script>
        // --- 1. DATOS Y L√ìGICA DE TURNOS ---
        
        function calculateReductionTime(festivos) {
            // Regla: Si hay festivos en la semana, entran a las 10:20 (se reduce menos).
            // Si NO hay festivos, entran a las 11:00 (se reduce m√°s).
            return festivos > 0 ? "10:20" : "11:00";
        }
        
        const LUNCH_TURNS = {
            T1: "11:30-12:30", 
            T2: "12:30-1:30",  
            T3: "1:30-2:30"    
        };

        const WEEKLY_LUNCH_ROTATION = [
            { Cristina: 'T1', Julio: 'T2', Steven: 'T3' }, 
            { Cristina: 'T3', Julio: 'T1', Steven: 'T2' }, 
            { Cristina: 'T2', Julio: 'T3', Steven: 'T1' }, 
            { Cristina: 'T3', Julio: 'T1', Steven: 'T2' }, 
            { Cristina: 'T1', Julio: 'T2', Steven: 'T3' },
            { Cristina: 'T2', Julio: 'T3', Steven: 'T1' },
            { Cristina: 'T3', Julio: 'T1', Steven: 'T2' },
            { Cristina: 'T1', Julio: 'T2', Steven: 'T3' },
            { Cristina: 'T2', Julio: 'T3', Steven: 'T1' },
            { Cristina: 'T3', Julio: 'T1', Steven: 'T2' },
            { Cristina: 'T1', Julio: 'T2', Steven: 'T3' },
            { Cristina: 'T2', Julio: 'T3', Steven: 'T1' },
            { Cristina: 'T3', Julio: 'T1', Steven: 'T2' },
            { Cristina: 'T1', Julio: 'T2', Steven: 'T3' },
        ];
        
        // Plan de Reducci√≥n donde TODOS tienen 1 d√≠a por semana.
        const WEEKLY_REDUCTION_PLAN = [
            // Sem 0 (Ene 1-4): Semana corta, no aplicamos reducciones estrictas o manuales.
            { Cristina: null, Julio: null, Steven: null }, 
            // Sem 1 (Ene 5-11): Normal (Cristina Mi√© 7)
            { Steven: 'Mar', Cristina: 'Mi√©', Julio: 'Jue' },
            // Sem 2 (Ene 12-18): Festivo Lun 12
            { Steven: 'Mi√©', Julio: 'Jue', Cristina: 'Vie' },
            // Sem 3 (Ene 19-25): Normal
            { Julio: 'Mar', Steven: 'Mi√©', Cristina: 'Jue' },
            // Sem 4 (Ene 26-31): Normal
            { Cristina: 'Mar', Julio: 'Mi√©', Steven: 'Vie' },
            // Sem 5 (Feb 1-7): Normal
            { Steven: 'Mar', Cristina: 'Mi√©', Julio: 'Jue' },
            // Sem 6 (Feb 8-14): Normal
            { Julio: 'Mar', Steven: 'Mi√©', Cristina: 'Vie' },
            // Sem 7 (Feb 15-21): Normal
            { Cristina: 'Mar', Julio: 'Mi√©', Steven: 'Jue' },
            // Sem 8 (Feb 22-28): Normal
            { Steven: 'Mar', Cristina: 'Mi√©', Julio: 'Vie' },
            // Sem 9 (Mar 1-7): Normal
            { Julio: 'Mar', Steven: 'Mi√©', Cristina: 'Jue' },
            // Sem 10 (Mar 8-14): Normal
            { Cristina: 'Mar', Julio: 'Mi√©', Steven: 'Vie' },
            // Sem 11 (Mar 15-21): Normal
            { Steven: 'Mar', Cristina: 'Mi√©', Julio: 'Jue' },
            // Sem 12 (Mar 22-28): Festivo Lun 23
            { Julio: 'Mi√©', Steven: 'Jue', Cristina: 'Vie' },
            // Sem 13 (Mar 29-31): Normal
            { Cristina: 'Mar', Julio: 'Mi√©', Steven: 'Jue' }
        ];

        function checkWeekFestivos(monthData, currentIndex) {
            let festivos = 0;
            // Buscar inicio de la semana (hacia atr√°s hasta Lunes o Domingo anterior)
            let start = currentIndex;
            while(start > 0 && monthData[start].w !== 'Lun' && monthData[start].d !== 1) {
                if(monthData[start].w === 'Dom') break; // Si llegamos a domingo, paramos
                start--;
            }
            // Si el d√≠a encontrado es domingo, la semana empieza el siguiente (start+1)
            // Si es lunes o dia 1, empieza ahi.
            if(monthData[start].w === 'Dom' && start !== currentIndex) start++;

            // Contar 7 d√≠as adelante
            for (let i = start; i < monthData.length && i < start + 7; i++) {
                if (monthData[i].type === 'Festivo') festivos++;
            }
            return festivos;
        }

        function generateSchedule(monthData) {
            const ADVISORS = ['Cristina', 'Julio', 'Steven'];
            const formattedData = [];
            
            let weekCounter = -1; 

            for (let i = 0; i < monthData.length; i++) {
                const day = monthData[i];

                if (i === 0 || (monthData[i-1] && monthData[i-1].w === 'Dom')) {
                    weekCounter++;
                }

                const weeklyLunch = WEEKLY_LUNCH_ROTATION[weekCounter] || WEEKLY_LUNCH_ROTATION[0];
                const reductionPlan = WEEKLY_REDUCTION_PLAN[weekCounter] || {};
                
                const festivosInWeek = checkWeekFestivos(monthData, i);
                
                const newDay = {...day};

                if (day.type !== 'Festivo' && day.type !== 'Descanso') {
                    
                    const reductionEntryTime = calculateReductionTime(festivosInWeek);
                    
                    const dailyTurnos = {
                        Cristina: weeklyLunch.Cristina,
                        Julio: weeklyLunch.Julio,
                        Steven: weeklyLunch.Steven
                    };

                    ADVISORS.forEach(adv => {
                        const baseTurno = dailyTurnos[adv];
                        const newInfo = { in: "08:30", out: day.w === 'S√°b' ? "16:00" : "17:30", lunch: LUNCH_TURNS[baseTurno], reduction: false };
                        
                        // Verificar si HOY es mi d√≠a de reducci√≥n
                        const myReductionDay = reductionPlan[adv];
                        const isMyReduction = day.w === myReductionDay && day.type !== 'Sabado';

                        if (isMyReduction) {
                            newInfo.in = reductionEntryTime; // 11:00 o 10:20
                            newInfo.reduction = true;
                            newInfo.lunch = LUNCH_TURNS.T3; // El de reducci√≥n toma T3
                        }

                        // L√≥gica de intercambio de almuerzos (Swap)
                        // Si mi turno base es T3, pero NO tengo reducci√≥n hoy...
                        // ... y ALGUIEN M√ÅS tiene reducci√≥n hoy (y por tanto me quita el T3)...
                        // ... yo tomo el turno base de esa persona.
                        if (!isMyReduction && baseTurno === 'T3') {
                            // Buscar quien tiene la reducci√≥n hoy
                            const reducerAdvisor = ADVISORS.find(a => reductionPlan[a] === day.w);
                            if (reducerAdvisor && day.type !== 'Sabado') {
                                // Tomar el turno base del reductor
                                newInfo.lunch = LUNCH_TURNS[dailyTurnos[reducerAdvisor]];
                            }
                        }

                        newDay[adv] = newInfo;
                    });
                }
                
                formattedData.push(newDay);
            }
            return formattedData;
        }

        const scheduleDB = {
            "Enero": generateSchedule([
                { d:1, w:"Jue", type:"Festivo", label:"A√±o Nuevo" },
                { d:2, w:"Vie", type:"Normal" },
                { d:3, w:"S√°b", type:"Sabado" },
                { d:4, w:"Dom", type:"Descanso" },
                { d:5, w:"Lun", type:"Normal" },
                { d:6, w:"Mar", type:"Normal" },
                { d:7, w:"Mi√©", type:"Normal" },
                { d:8, w:"Jue", type:"Normal" },
                { d:9, w:"Vie", type:"Normal" },
                { d:10, w:"S√°b", type:"Sabado" },
                { d:11, w:"Dom", type:"Descanso" },
                { d:12, w:"Lun", type:"Festivo", label:"Reyes Magos" },
                { d:13, w:"Mar", type:"Normal" },
                { d:14, w:"Mi√©", type:"Normal" },
                { d:15, w:"Jue", type:"Normal" },
                { d:16, w:"Vie", type:"Normal" },
                { d:17, w:"S√°b", type:"Sabado" },
                { d:18, w:"Dom", type:"Descanso" },
                { d:19, w:"Lun", type:"Normal" },
                { d:20, w:"Mar", type:"Normal" },
                { d:21, w:"Mi√©", type:"Normal" },
                { d:22, w:"Jue", type:"Normal" },
                { d:23, w:"Vie", type:"Normal" },
                { d:24, w:"S√°b", type:"Sabado" },
                { d:25, w:"Dom", type:"Descanso" },
                { d:26, w:"Lun", type:"Normal" },
                { d:27, w:"Mar", type:"Normal" },
                { d:28, w:"Mi√©", type:"Normal" },
                { d:29, w:"Jue", type:"Normal" },
                { d:30, w:"Vie", type:"Normal" },
                { d:31, w:"S√°b", type:"Sabado" },
            ]),
            "Febrero": generateSchedule([
                { d:1, w:"Dom", type:"Descanso" },
                { d:2, w:"Lun", type:"Normal" },
                { d:3, w:"Mar", type:"Normal" },
                { d:4, w:"Mi√©", type:"Normal" },
                { d:5, w:"Jue", type:"Normal" },
                { d:6, w:"Vie", type:"Normal" },
                { d:7, w:"S√°b", type:"Sabado" },
                { d:8, w:"Dom", type:"Descanso" },
                { d:9, w:"Lun", type:"Normal" },
                { d:10, w:"Mar", type:"Normal" },
                { d:11, w:"Mi√©", type:"Normal" },
                { d:12, w:"Jue", type:"Normal" },
                { d:13, w:"Vie", type:"Normal" },
                { d:14, w:"S√°b", type:"Sabado" },
                { d:15, w:"Dom", type:"Descanso" },
                { d:16, w:"Lun", type:"Normal" },
                { d:17, w:"Mar", type:"Normal" },
                { d:18, w:"Mi√©", type:"Normal" },
                { d:19, w:"Jue", type:"Normal" },
                { d:20, w:"Vie", type:"Normal" },
                { d:21, w:"S√°b", type:"Sabado" },
                { d:22, w:"Dom", type:"Descanso" },
                { d:23, w:"Lun", type:"Normal" },
                { d:24, w:"Mar", type:"Normal" },
                { d:25, w:"Mi√©", type:"Normal" },
                { d:26, w:"Jue", type:"Normal" },
                { d:27, w:"Vie", type:"Normal" },
                { d:28, w:"S√°b", type:"Sabado" },
            ]),
            "Marzo": generateSchedule([
                { d:1, w:"Dom", type:"Descanso" },
                { d:2, w:"Lun", type:"Normal" },
                { d:3, w:"Mar", type:"Normal" },
                { d:4, w:"Mi√©", type:"Normal" },
                { d:5, w:"Jue", type:"Normal" },
                { d:6, w:"Vie", type:"Normal" },
                { d:7, w:"S√°b", type:"Sabado" },
                { d:8, w:"Dom", type:"Descanso" },
                { d:9, w:"Lun", type:"Normal" },
                { d:10, w:"Mar", type:"Normal" },
                { d:11, w:"Mi√©", type:"Normal" },
                { d:12, w:"Jue", type:"Normal" },
                { d:13, w:"Vie", type:"Normal" },
                { d:14, w:"S√°b", type:"Sabado" },
                { d:15, w:"Dom", type:"Descanso" },
                { d:16, w:"Lun", type:"Normal" },
                { d:17, w:"Mar", type:"Normal" },
                { d:18, w:"Mi√©", type:"Normal" },
                { d:19, w:"Jue", type:"Normal" },
                { d:20, w:"Vie", type:"Normal" },
                { d:21, w:"S√°b", type:"Sabado" },
                { d:22, w:"Dom", type:"Descanso" },
                { d:23, w:"Lun", type:"Festivo", label:"D√≠a de San Jos√©" },
                { d:24, w:"Mar", type:"Normal" },
                { d:25, w:"Mi√©", type:"Normal" },
                { d:26, w:"Jue", type:"Normal" },
                { d:27, w:"Vie", type:"Normal" },
                { d:28, w:"S√°b", type:"Sabado" },
                { d:29, w:"Dom", type:"Descanso" },
                { d:30, w:"Lun", type:"Normal" },
                { d:31, w:"Mar", type:"Normal" },
            ])
        };

        // --- 4. GESTI√ìN DE ESTADO ---
        let state = {
            advisor: 'Cristina', 
            month: 'Enero',
            weekIndex: 0 
        };

        // --- 5. FUNCIONES DE RENDERIZADO Y L√ìGICA DE VISTA ---

        function selectAdvisor(name) {
            state.advisor = name;
            
            // 1. Tema
            document.body.className = `flex items-center justify-center p-4 md:p-8 theme-${name.toLowerCase()}`;
            
            // 2. Sidebar Active
            document.querySelectorAll('.advisor-card').forEach(card => card.classList.remove('active'));
            document.getElementById(`card-${name}`).classList.add('active');

            // 3. Header Text
            document.getElementById('header-name').innerText = name;
            document.getElementById('modal-subtitle').innerText = `${state.month} 2026 - ${name}`;

            // 4. Render
            renderWeekView();
        }

        function changeMonth(month) {
            state.month = month;
            state.weekIndex = 0; 

            ['Enero', 'Febrero', 'Marzo'].forEach(m => {
                const btn = document.getElementById(`btn-${m}`);
                btn.classList.remove('active');

                if (m === month) {
                    btn.classList.add('active');
                    btn.className = "month-tab px-5 py-2 rounded-lg text-sm font-bold shadow-sm bg-white text-gray-800 transition-all active";
                } else {
                    btn.className = "month-tab px-5 py-2 rounded-lg text-sm font-semibold text-gray-500 hover:text-gray-800 transition-all";
                }
            });

            document.getElementById('modal-subtitle').innerText = `${month} 2026 - ${state.advisor}`;
            renderWeekView();
        }

        function changeWeek(direction) {
            const data = scheduleDB[state.month];
            const maxWeeks = Math.ceil(data.length / 7) - 1;
            
            let newIndex = state.weekIndex + direction;
            if (newIndex < 0) return; 
            if (newIndex > maxWeeks) return; 

            state.weekIndex = newIndex;
            renderWeekView();
        }

        function renderWeekView() {
            const grid = document.getElementById('weekly-grid');
            grid.innerHTML = ""; 

            const monthData = scheduleDB[state.month];
            const startIdx = state.weekIndex * 7;
            const endIdx = startIdx + 7;
            const weekData = monthData.slice(startIdx, endIdx);

            document.getElementById('week-display').innerText = `Semana ${state.weekIndex + 1}`;
            if(weekData.length > 0) {
                const first = weekData[0].d;
                const last = weekData[weekData.length - 1].d;
                document.getElementById('date-range-display').innerText = `${state.month} ${first} - ${state.month} ${last}`;
            }

            weekData.forEach((day, index) => {
                const card = document.createElement('div');
                card.className = "card-container glass-panel p-5 rounded-3xl flex flex-col justify-between relative overflow-hidden group hover:shadow-xl transition-all animate-fade-in";
                card.style.animationDelay = `${index * 0.05}s`;

                let contentHTML = "";
                let borderClass = "";
                let iconClass = "";
                let bgDecoration = "";

                // Generar contenido del Tooltip
                let tooltipContent = '';
                let coverageBar = '';
                const ADVISORS = ['Cristina', 'Julio', 'Steven'];

                if (day.type !== 'Festivo' && day.type !== 'Descanso') {
                    tooltipContent += `<div class="p-4 bg-white/95 rounded-xl shadow-lg border border-gray-100 space-y-2 text-xs font-medium">`;
                    tooltipContent += `<h5 class="font-bold text-gray-800 border-b pb-1 mb-1 flex items-center gap-1"><i class="fa-solid fa-people-group text-indigo-500"></i> Horarios Operativos</h5>`;
                    
                    ADVISORS.forEach(adv => {
                        const info = day[adv];
                        const statusIcon = info.reduction ? '‚≠ê' : 'üíº';
                        const statusClass = info.reduction ? 'text-indigo-600 font-bold' : 'text-gray-700';
                        
                        tooltipContent += `<div class="flex justify-between ${statusClass}">
                            <span>${statusIcon} ${adv}</span>
                            <span>Entra: ${info.in}</span>
                            <span>Alm: ${info.lunch.split('-')[0].trim()}</span>
                        </div>`;
                    });
                    tooltipContent += `</div>`;
                    
                    coverageBar = `
                        <div class="absolute top-0 left-0 w-full h-1 bg-green-200">
                            <div class="h-full w-full bg-green-500 rounded-full"></div>
                            <span class="absolute right-1 top-2 text-[10px] font-bold text-gray-600">3/3 Cobertura</span>
                        </div>
                    `;
                }

                if (day.type === 'Festivo') {
                    borderClass = "border-l-4 border-red-400";
                    iconClass = "fa-umbrella-beach text-red-400";
                    contentHTML = `
                        <div class="mt-auto">
                            <span class="px-3 py-1 bg-red-100 text-red-600 rounded-full text-xs font-bold uppercase tracking-wide">Festivo</span>
                            <p class="mt-2 text-lg text-red-800 font-bold">${day.label}</p>
                        </div>
                    `;
                } else if (day.type === 'Descanso') {
                    borderClass = "border-l-4 border-gray-300";
                    iconClass = "fa-bed text-gray-400";
                    contentHTML = `
                        <div class="mt-auto">
                             <span class="px-3 py-1 bg-gray-200 text-gray-500 rounded-full text-xs font-bold uppercase tracking-wide">Descanso</span>
                        </div>
                    `;
                } else {
                    const info = day[state.advisor];
                    if (info) {
                        const isReduction = info.reduction;
                        borderClass = isReduction ? "border-l-4 border-indigo-500 bg-indigo-50/30" : "border-l-4 border-emerald-400";
                        iconClass = isReduction ? "fa-star text-indigo-500" : "fa-briefcase text-emerald-500";
                        
                        let reductionLabel = "";
                        if(isReduction) {
                            bgDecoration = `<div class="absolute -right-6 -top-6 w-20 h-20 bg-gradient-theme opacity-20 rounded-full blur-xl"></div>`;
                            let labelText = info.in === "11:00" ? "Jornada Reducida (11:00 AM)" : `Reducci√≥n (Ajuste ${info.in})`;
                            reductionLabel = `<span class="text-[10px] text-indigo-600 font-bold uppercase tracking-wider">‚≠ê ${labelText}</span>`;
                        }

                        contentHTML = `
                            <div class="space-y-3 mt-2">
                                <div class="flex justify-between items-center">
                                    <span class="text-xs text-gray-400 font-bold uppercase">Entrada</span>
                                    <span class="text-lg font-bold text-gray-800">${info.in}</span>
                                </div>
                                <div class="flex justify-between items-center">
                                    <span class="text-xs text-gray-400 font-bold uppercase">Salida</span>
                                    <span class="text-lg font-bold text-gray-800">${info.out}</span>
                                </div>
                                <div class="pt-3 border-t border-gray-200/50 flex items-center gap-2">
                                    <i class="fa-solid fa-utensils text-gray-400 text-xs"></i>
                                    <span class="text-sm font-medium text-gray-600">Alm: ${info.lunch}</span>
                                </div>
                                ${reductionLabel}
                            </div>
                        `;
                    }
                }

                card.innerHTML = `
                    ${coverageBar}
                    <div class="flex justify-between items-start mb-2 relative z-10">
                        <div>
                            <h4 class="text-3xl font-bold text-gray-800">${day.d}</h4>
                            <p class="text-sm font-bold uppercase tracking-wider text-gray-400">${day.w}</p>
                        </div>
                        <div class="w-10 h-10 rounded-full bg-white flex items-center justify-center shadow-sm text-lg ${iconClass}">
                            <i class="fa-solid ${iconClass.split(' ')[0]}"></i>
                        </div>
                    </div>
                    ${contentHTML}
                    ${bgDecoration}
                    
                    <div class="tooltip absolute top-1/2 left-full ml-4 z-50 w-64 transform -translate-y-1/2">
                        ${tooltipContent}
                    </div>
                `;
                
                card.classList.add(...borderClass.split(' '));
                grid.appendChild(card);
            });
        }

        // --- MODAL LOGIC ---
        function openMonthModal() {
            const modal = document.getElementById('month-modal');
            const tbody = document.getElementById('month-table-body');
            tbody.innerHTML = "";

            const fullData = scheduleDB[state.month];
            
            fullData.forEach(day => {
                let rowHTML = "";
                let baseClass = "border-b hover:bg-gray-50 transition";
                
                if(day.type === 'Festivo') {
                    rowHTML = `<td colspan="5" class="px-6 py-4 font-bold text-red-500 bg-red-50 text-center">FESTIVO: ${day.label}</td>`;
                } else if(day.type === 'Descanso') {
                    rowHTML = `<td colspan="5" class="px-6 py-4 italic text-gray-400 bg-gray-50 text-center">D√≠a de Descanso</td>`;
                } else {
                    const info = day[state.advisor];
                    if(info) {
                        const style = info.reduction ? 'font-bold text-indigo-600' : 'text-gray-700';
                        let note = "-";
                        if(info.reduction) {
                            note = `‚òÖ Reducci√≥n (${info.in})`;
                        } else if(day.type === 'Sabado') {
                            note = "S√°bado (6.5h)";
                        }
                        
                        rowHTML = `
                            <td class="px-6 py-4 font-medium">${day.d} / ${day.w}</td>
                            <td class="px-6 py-4">${day.w}</td>
                            <td class="px-6 py-4 ${style}">${info.in} - ${info.out}</td>
                            <td class="px-6 py-4">${info.lunch}</td>
                            <td class="px-6 py-4 text-xs">${note}</td>
                        `;
                    }
                }

                const tr = document.createElement('tr');
                tr.className = baseClass;
                tr.innerHTML = rowHTML;
                tbody.appendChild(tr);
            });

            modal.showModal();
        }

        function closeMonthModal() {
            document.getElementById('month-modal').close();
        }

        document.addEventListener('DOMContentLoaded', () => {
            selectAdvisor('Cristina');
            document.getElementById('btn-Enero').classList.add('active');
        });
    </script>
</body>
</html>